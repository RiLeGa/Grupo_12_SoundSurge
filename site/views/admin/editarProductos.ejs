<!DOCTYPE html>
<html lang="en">
<%- include ("../partials/head",{title: "Editar Producto" }) %>

    <body >
        <%- include ("../partials/header") %>
            <main class="editar">
                <a class="direct-lista" href="/admin/lista">
                    <button type="button" id="boton" class="btn btn-primary">Lista de productos</button>
                </a>
                <a class="direct-lista-flecha" href="/admin/lista">
                    <i class="fa-solid fa-arrow-left"></i>
                </a>
                <h2>Modificar Producto</h2>

                <section>
                    <form action="/admin/editar/<%= producto.id %>?_method=put" method="post"
                        enctype="multipart/form-data">
                        <section class="cajita">
                            <section>
                                <article class="articulo1">
                                    <div class="caja1">

                                        <div class="mb-3" id="contenedores">
                                            <label for="marcas" class="form-label">MARCAS</label>
                                            <select class="form-select" name="marcas" id="marcas"
                                                aria-label="select example">

                                                <option selected hidden value="">Selecciona una opcion</option>
                                                <% marcas.forEach(marca=> { %>
                                                    <option value="<%= marca.id %>" <%=producto.marcasId===marca.id
                                                        ? "selected" : null %>><%= marca.nombre %>
                                                    </option>
                                                    <% }) %>
                                            </select>
                                            <p class="error" id="marcaError">
                                                <%= locals.errors && errors.marcas ? errors.marcas.msg : null %>
                                            </p>
                                        </div>
                                        <div class="mb-3" id="contenedores">
                                            <label for="formGroupExampleInput2" class="form-label">Titulo</label>
                                            <input type="text" class="form-control" name="titulo" id="titulo"
                                                placeholder="Ingrese marca del producto"
                                                value="<%= producto.titulo %> ">
                                            <p class="error" id="tituloError">
                                                <%= locals.errors && errors.titulo ? errors.titulo.msg : null %>
                                            </p>
                                        </div>
                                    </div>
                                    <div class="caja2">
                                        <div class="mb-3" id="contenedores">
                                            <label for="formGroupExampleInput2" class="form-label">Precio</label>
                                            <input type="text" class="form-control" name="precio" id="precio"
                                                placeholder="Ingrese precio del producto"
                                                value="<%= producto.precio %>">
                                            <p class="error" id="precioError">
                                                <%= locals.errors && errors.precio ? errors.precio.msg : null %>
                                            </p>
                                        </div>
                                        <div class="mb-3" id="contenedores">
                                            <label for="formGroupExampleInput2" class="form-label">Descuento</label>
                                            <input type="text" class="form-control" name="descuento" id="descuento"
                                                placeholder="Ingrese su descuento" value="<%= producto.descuento %>">
                                            <p class="error" id="descuentoError">
                                                <%= locals.errors && errors.descuento ? errors.descuento.msg : null %>
                                            </p>
                                        </div>
                                    </div>
                                </article>
                                <article class="articulo2">
                                    <div class="caja33" id="desaparecer">
                                        <div class="mb-3" id="descripcion">
                                            <label for="formGroupExampleInput2" class="form-label">Descripcion</label>

                                            <textarea value="<%= producto.descripcion %>" name="descripcion"
                                                id="descripcion" cols="1" rows="6" class="form-control"
                                                placeholder="Ingrese descripcion"
                                                style="resize: none;"><%= producto.descripcion %></textarea>
                                            <p class="error" id="descripcionError">
                                                <%= locals.errors && errors.descripcion ? errors.descripcion.msg : null
                                                    %>
                                            </p>
                                        </div>
                                    </div>
                                    <div class="caja3">
                                        <div class="mb-3"  id="contenedores">
                                            <label for="formGroupExampleInput2" class="form-label">Stock</label>
                                            <input type="text" class="form-control" name="stock" id="stock"
                                                placeholder="Stock disponible" value="<%= producto.stock %>">
                                            <p class="error" id="stockError">
                                                <%= locals.errors && errors.stock ? errors.stock.msg : null %>
                                            </p>
                                        </div>

                                        <div class="mb-3" id="contenedores">
                                            <label for="categorias" class="form-label">CATEGORIAS</label>
                                            <select class="form-select" name="categorias" id="categorias"
                                                aria-label="select example">

                                                <option selected hidden value="">Selecciona una opcion</option>
                                               
                                                <% categorias.forEach(categoria=> { %>
                                                    <option value="<%= categoria.id %>"
                                                        <%=producto.categoriasId===categoria.id ? "selected" : null %>>
                                                        <%= categoria.nombre %>
                                                    </option>
                                                    <% }) %>
                                                 
                                            </select>
                                            <p class="error" id="categoriaError">
                                                <%= locals.errors && errors.categorias ? errors.categorias.msg : null %>
                                            </p>
                                        </div>
                                    </div>
                        </div>
                        
                        </article>
                        
                </section>
                
                <section class="section-imagenes">
                  
                        
                        <div class="imagenes-secc">
                              <div class="divisor-label">     
                            <label class="label-imagen" for="imagen">
                                <input type="file" class="input-invisible" id="imagen" name="imagen1">
                               <img class="secundarias2" id="img-preview" style="background-image:url('/images/<%= producto.imagenes[0].nombre %>')">
                               
                                </img>
                                <p class="p-imagen">Toca para seleccionar una imagen</p>
                                    <p class="error" id="imagenError"></p>
                            </label>
                            <label class="label-imagen" for="imagen2">
                                
                                <input type="file" class="input-invisible" name="imagen2" id="imagen2">
                                <% if(producto.imagenes.length <2){ %> 
                                    <img class="secundarias2" id="sub-img-preview-1" style="background-color:white">
                                
                               <% }else{ %>
                                <img class="secundarias2" id="sub-img-preview-1" style="background-image:url('/images/<%= producto.imagenes[1].nombre %>')">
                                <% } %>
                                </img>
                                <p class="p-imagen">Toca para seleccionar una imagen</p>
                                    <p class="error" id="imagenError2"></p>
                            </label>
                        </div> 
                        <div class="divisor-label">
                            <label class="label-imagen" for="imagen3">
                                <input type="file" class="input-invisible" id="imagen3" name="imagen3">
                                <% if(producto.imagenes.length <3){ %> 
                                    <img class="secundarias2" id="sub-img-preview-2" style="background-color:white">
                                
                               <% }else{ %>
                                <img class="secundarias2" id="sub-img-preview-2" style="background-image:url('/images/<%= producto.imagenes[2].nombre %>')">
                                <% }%>
                                </img>
                                <p class="p-imagen">Toca para seleccionar una imagen</p>
                                    <p class="error" id="imagenError3"></p>
                            </label>
                            <label class="label-imagen" for="imagen4">
                                <input type="file" class="input-invisible" id="imagen4" name="imagen4">
                                <% if(producto.imagenes.length <4){ %> 
                                    <img class="secundarias2" id="sub-img-preview-3" style="background-color:white">
                                
                               <% }else{ %>
                                <img class="secundarias2" id="sub-img-preview-3" style="background-image:url('/images/<%= producto.imagenes[3].nombre %>')">
                                
                                <% } %>  
                                </img>
                                <p class="p-imagen">Toca para seleccionar una imagen</p>
                                    <p class="error" id="imagenError4"></p>
                                   
                            </label>
                        </div>
                        </div>

                    
                </section>
                </div>
                </section>
                <section>
                   
                    <article class="articulo22">
                        <div class="caja33">
                            <div class="mb-3" id="descripcion2">
                                <label for="formGroupExampleInput2" class="label-descripcion">Descripcion</label>

                                <textarea value="<%= producto.descripcion %>" name="descripcion" for="descripcion"
                                    id="descripcion" cols="1" rows="6" class="form-control"
                                    placeholder="Ingrese descripcion"
                                    style="resize: none;"><%= producto.descripcion %></textarea>
                                <p class="error" id="descripcionError">
                                    <%= locals.errors && errors.descripcion ? errors.descripcion.msg : null
                                        %>
                                </p>
                            </div>
                        </div>
                        
            </div>
            
            </article>
            
    </section>
                
                <div class="botones">
                    <button class="btn btn-primary" id='#btn-submit' type="submit">Confirma</button>
                    <button class="btn btn-secundary"><a href="/admin/lista">Cancelar</a></button>
                </div>

                </form>
                </section>
            </main>
            <script src="/javascript/validacionProductos.js"></script>
            <script src="/javascript/imagenes.js"></script>
    </body>

</html>